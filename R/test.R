test<-data.frame(
  X1=c(8.3, 8.6, 8.8, 10.5, 10.7, 10.8, 11, 11, 11.1, 11.2,
       11.3, 11.4, 11.4, 11.7, 12, 12.9, 12.9, 13.3, 13.7, 13.8),
  X2=c(70, 65, 63, 72, 81, 83, 66, 75, 80, 75,
       79, 76, 76, 69, 75, 74, 85, 86, 71, 64),
  X3=c(10.3, 10.3, 10.2, 16.4, 18.8, 19.7, 15.6, 18.2, 22.6, 19.9,
       24.2, 21, 21.4, 21.3, 19.1, 22.2, 33.8, 27.4, 25.7, 24.9),
  X4=c(2.1, 2.2, 2.5, 2.7, 2.8, 2.4, 2.1, 2.4, 2.5, 2.9,
       3.1, 3.4, 3.2, 3.3, 3.3, 3.0, 3.3, 4.1, 4.0, 3.9),
  Y1=c(41, 36, 12, 18, 21, 28, 23, 19, 8, 12,
       7, 16, 11, 14, 18, 14, 34, 6, 30, 11),
  Y2=c(190, 118, 149, 313, 300, 154, 299, 99, 19, 194,
       156, 256, 290, 274, 65, 334, 307, 78, 322, 44),
  Y3=c(7.4, 8, 12.6, 11.5, 14.3, 14.9, 8.6, 13.8, 20.1, 8.6,
       6.9, 9.7, 9.2, 10.9, 13.2, 11.5, 12, 18.4, 11.5, 9.7),
  Y4=c(67, 72, 74, 62, 56, 66, 65, 59, 61, 69,
       74, 69, 66, 68, 58, 64, 66, 57, 68, 62)
)

test <- scale(test)
cca(test[,1:4],test[,5:8])
cca_advanced(test[,1:4],test[,5:8])
cancor(test[,1:4],test[,5:8])

(dtf <- data.frame(Weight = c(60.1, 60.38,  59.74,  58.04,  59.67,  59.44,  58.7,   59.75,  60.5,   56.95),
                   Height = c(173.28,   172.09, 171.46, 170.08, 170.61, 171.69, 171.46, 171.6,  171.6,  171.16),
                   Lung_capacity = c(4508,  4469,   4398,   4068,   4339,   4393,   4389,   4306,   4395,   4462),
                   Pulse = c(75.3,  76.7,   75.8,   76.1,   72.9,   72.7,   76.5,   75.2,   74.7,   73.2),
                   Systolic_blood_pressure = c(117.4,   120.1,  121.8,  115.1,  119.4,  116.2,  117.9,  115.1,  117.4,  113.2)))
df <- scale(dtf)
A <- df[,1:2]
B <- df[,3:5]
ca <-cca(A,B)
cancor(A,B,xcenter=FALSE,ycenter = FALSE)

x <- test[,1:4]
y <- test[,5:8]
cov_xx <- cov(x)

library(pracma)
sqrtm(cov_xx)$Binv
solve(matrixsqrt(cov_xx))
